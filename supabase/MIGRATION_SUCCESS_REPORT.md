# ‚úÖ –û—Ç—á–µ—Ç –æ–± —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –¢–µ—Ö–Ω–æ–ú–æ–¥–µ—Ä–Ω

**–î–∞—Ç–∞:** 2025-11-11
**–ü—Ä–æ–µ–∫—Ç:** –¢–µ—Ö–Ω–æ–ú–æ–¥–µ—Ä–Ω - B2B –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∑–∞–∫—É–ø–æ–∫ —É –∫–∏—Ç–∞–π—Å–∫–∏—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
**Supabase Project:** rbngpxwamfkunktxjtqh
**–ú–∏–≥—Ä–∞—Ü–∏—è:** 001_create_catalog_tables.sql

---

## –°—Ç–∞—Ç—É—Å: –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û ‚úÖ

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
- ‚úÖ 20 –∏–∑ 22 SQL –∫–æ–º–∞–Ω–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- ‚ö†Ô∏è 2 –∫–æ–º–∞–Ω–¥—ã COMMENT –ø–æ–ª—É—á–∏–ª–∏ timeout (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- ‚úÖ –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –í—Å–µ –∏–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

## –°–æ–∑–¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### üìã –¢–∞–±–ª–∏—Ü—ã (4)

#### 1. **suppliers** - –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
–ö–æ–ª–æ–Ω–æ–∫: 10

| ‚Ññ | –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | NULL | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|---|---------|-----|------|--------------|
| 1 | id | uuid | NO | gen_random_uuid() |
| 2 | name | text | NO | - |
| 3 | description | text | YES | - |
| 4 | country | text | YES | - |
| 5 | logo_url | text | YES | - |
| 6 | verified | boolean | YES | false |
| 7 | rating | numeric(3,2) | YES | 0.00 |
| 8 | total_orders | integer | YES | 0 |
| 9 | created_at | timestamptz | YES | now() |
| 10 | updated_at | timestamptz | YES | now() |

**–ò–Ω–¥–µ–∫—Å—ã:**
- suppliers_pkey (PRIMARY KEY)

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- update_suppliers_updated_at (BEFORE UPDATE)

---

#### 2. **categories** - 3-—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
–ö–æ–ª–æ–Ω–æ–∫: 10

| ‚Ññ | –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | NULL | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|---|---------|-----|------|--------------|
| 1 | id | uuid | NO | gen_random_uuid() |
| 2 | name | text | NO | - |
| 3 | slug | text | NO | - |
| 4 | icon | text | YES | - |
| 5 | parent_id | uuid | YES | - |
| 6 | level | integer | NO | 1 |
| 7 | display_order | integer | YES | 0 |
| 8 | product_count | integer | YES | 0 |
| 9 | created_at | timestamptz | YES | now() |
| 10 | updated_at | timestamptz | YES | now() |

**–ò–Ω–¥–µ–∫—Å—ã:**
- categories_pkey (PRIMARY KEY)
- categories_slug_key (UNIQUE)
- idx_categories_level
- idx_categories_parent

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- update_categories_updated_at (BEFORE UPDATE)

---

#### 3. **products** - –¢–æ–≤–∞—Ä—ã —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
–ö–æ–ª–æ–Ω–æ–∫: 17

| ‚Ññ | –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | NULL | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|---|---------|-----|------|--------------|
| 1 | id | uuid | NO | gen_random_uuid() |
| 2 | supplier_id | uuid | YES | - |
| 3 | category_id | uuid | YES | - |
| 4 | name | text | NO | - |
| 5 | description | text | YES | - |
| 6 | sku | text | YES | - |
| 7 | price | numeric(10,2) | NO | - |
| 8 | currency | text | YES | 'USD' |
| 9 | min_order | integer | YES | 1 |
| 10 | in_stock | boolean | YES | true |
| 11 | images | text[] | YES | '{}' |
| 12 | specifications | jsonb | YES | '{}' |
| 13 | tags | text[] | YES | '{}' |
| 14 | views | integer | YES | 0 |
| 15 | orders | integer | YES | 0 |
| 16 | created_at | timestamptz | YES | now() |
| 17 | updated_at | timestamptz | YES | now() |

**–ò–Ω–¥–µ–∫—Å—ã:**
- products_pkey (PRIMARY KEY)
- products_sku_key (UNIQUE)
- idx_products_supplier
- idx_products_category
- idx_products_in_stock
- idx_products_name (GIN, full-text search –Ω–∞ —Ä—É—Å—Å–∫–æ–º)
- idx_products_description (GIN, full-text search –Ω–∞ —Ä—É—Å—Å–∫–æ–º)

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- update_products_updated_at (BEFORE UPDATE)

---

#### 4. **project_carts** - –ö–æ—Ä–∑–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–ö–æ–ª–æ–Ω–æ–∫: 9

| ‚Ññ | –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | NULL | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|---|---------|-----|------|--------------|
| 1 | id | uuid | NO | gen_random_uuid() |
| 2 | user_id | text | NO | - |
| 3 | product_id | uuid | YES | - |
| 4 | quantity | integer | NO | 1 |
| 5 | price | numeric(10,2) | NO | - |
| 6 | total_price | numeric(10,2) | NO | - |
| 7 | currency | text | YES | 'USD' |
| 8 | created_at | timestamptz | YES | now() |
| 9 | updated_at | timestamptz | YES | now() |

**–ò–Ω–¥–µ–∫—Å—ã:**
- project_carts_pkey (PRIMARY KEY)
- project_carts_user_id_product_id_key (UNIQUE)
- idx_project_carts_user
- idx_project_carts_product

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- update_project_carts_updated_at (BEFORE UPDATE)

---

### ‚öôÔ∏è –§—É–Ω–∫—Ü–∏–∏ (1)

1. **update_updated_at_column()** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è updated_at –ø—Ä–∏ UPDATE

---

### üîó –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

```
suppliers (1) ‚îÄ‚îÄ‚Üí (N) products
categories (1) ‚îÄ‚îÄ‚Üí (N) categories (self-reference –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–∏)
categories (1) ‚îÄ‚îÄ‚Üí (N) products
products (1) ‚îÄ‚îÄ‚Üí (N) project_carts
```

---

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. Full-Text Search (–ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫)
- –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
- –ò–Ω–¥–µ–∫—Å—ã GIN –Ω–∞ –ø–æ–ª—è—Ö `name` –∏ `description` —Ç–∞–±–ª–∏—Ü—ã `products`
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –∏—Å–∫–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ –æ–ø–∏—Å–∞–Ω–∏—é

### 2. –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- 3 —É—Ä–æ–≤–Ω—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ `parent_id`
- –ü–æ–ª–µ `level` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —É—Ä–æ–≤–Ω—è–º
- –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ timestamp
- –¢—Ä–∏–≥–≥–µ—Ä—ã –æ–±–Ω–æ–≤–ª—è—é—Ç `updated_at` –ø—Ä–∏ –∫–∞–∂–¥–æ–º UPDATE
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö 4 —Ç–∞–±–ª–∏—Ü–∞—Ö

### 4. JSONB –¥–ª—è –≥–∏–±–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–ª–µ `specifications` –≤ —Ç–∞–±–ª–∏—Ü–µ `products` —Ö—Ä–∞–Ω–∏—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ª—é–±—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã

### 5. –ú–∞—Å—Å–∏–≤—ã –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- `images` - –º–∞—Å—Å–∏–≤ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–∞
- `tags` - —Ç–µ–≥–∏ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤

| –¢–∞–±–ª–∏—Ü–∞ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–¥–µ–∫—Å–æ–≤ |
|---------|---------------------|
| suppliers | 1 |
| categories | 4 |
| products | 7 |
| project_carts | 4 |
| **–í–°–ï–ì–û** | **16** |

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (RLS)

Row Level Security **–æ—Ç–∫–ª—é—á–µ–Ω** –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

–í production –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
```sql
ALTER TABLE suppliers ENABLE ROW LEVEL SECURITY;
ALTER TABLE categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE products ENABLE ROW LEVEL SECURITY;
ALTER TABLE project_carts ENABLE ROW LEVEL SECURITY;
```

–ò –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã.

---

## ‚úÖ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –≤ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü–µ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å full-text search

2. **API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - –°–æ–∑–¥–∞—Ç—å API endpoints –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ

3. **–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏:**
   - –ò–º–ø–æ—Ä—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π
   - –ò–º–ø–æ—Ä—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
   - –ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤

4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
   - –í–∫–ª—é—á–∏—Ç—å RLS
   - –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ü–æ–ª–µ `user_id` –≤ `project_carts` –ø–æ–∫–∞ –∏–º–µ–µ—Ç —Ç–∏–ø TEXT
- –í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ UUID —Å –≤–Ω–µ—à–Ω–∏–º –∫–ª—é—á–æ–º –Ω–∞ `auth.users`
- –í–∞–ª—é—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: USD
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1 –µ–¥–∏–Ω–∏—Ü–∞
- –†–µ–π—Ç–∏–Ω–≥ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤: –æ—Ç 0.00 –¥–æ 9.99

---

## üõ† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **PostgreSQL** 15+
- **Supabase** (BaaS)
- **Full-Text Search** (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)
- **JSONB** –¥–ª—è –≥–∏–±–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **GIN indexes** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–∞
- **Triggers** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

---

**–ê–≤—Ç–æ—Ä:** Claude Code AI Assistant
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-11
