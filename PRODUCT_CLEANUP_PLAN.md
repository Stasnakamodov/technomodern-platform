# План полной очистки и нормализации товаров

## Текущее состояние (проблемы)

### 1. Нерелевантные товары в категориях
- **Умный дом**: одеяла, подушки, матрасы (должны быть в Текстиль/Спальня)
- **Шины и диски**: стиральные машины, полировка (должны быть в Автохимия)
- **Витамины и БАД**: гидравлические клапаны, сыворотки для лица
- **Двери и окна**: выключатели, розетки, умные лампы (Электрика)
- **Аксессуары и фурнитура**: сексуальное белье, видеорегистраторы
- **Хозяйственные товары**: мебель, мясорубки (Кухонная техника)
- **Строительные материалы**: книги, выключатели
- **Ткани**: матрасы, подушки (Спальня/Текстиль)

### 2. Мусорные названия товаров (машинный перевод с китайского)
Примеры:
- "Автомобильная машина с высоким давлением на роликах 36 л"
- "Бесщеточная беспроводная электрическая круглая пила 165 -..."
- "Крем крема для лица витамина С Удалить темные пятна отбел..."
- "Сыворот" (обрезано)
- "В 21 мая" (бессмыслица)
- "Верх!" (мусор)

### 3. Цены требуют конвертации в рубли

**Анализ цен показал:**
- Минимальная цена: $0.07 (накладки на углы)
- Максимальная цена: $140,482 (матрас Sealy)
- Средний диапазон: $10-100

**Вывод: Цены в ДОЛЛАРАХ США (USD)** - оптовые цены с китайских площадок (Alibaba/1688)

**Примеры для проверки:**
| Товар | Текущая цена | Если USD→RUB (×100) |
|-------|-------------|---------------------|
| USB кабель | 0.16 | 16 ₽ |
| Омега-3 120 капсул | 44.86 | 4,486 ₽ |
| Подставка для ноутбука | 20.58 | 2,058 ₽ |
| Сварочный аппарат MIG250 | 61.75 | 6,175 ₽ |
| Матрас Sealy 1.8м | 140,482 | 14,048,200 ₽ |

**Формула конвертации с наценкой:**
```
Цена в рублях = Цена в USD × 100 × 1.3
```
- Курс: 1 USD = 100 RUB
- Наценка: ×1.3 (30% маржа)

**Итоговые примеры:**
| Товар | USD | RUB (с наценкой 30%) |
|-------|-----|----------------------|
| USB кабель | 0.16 | 21 ₽ |
| Омега-3 120 капсул | 44.86 | 5,832 ₽ |
| Подставка для ноутбука | 20.58 | 2,675 ₽ |
| Сварочный аппарат MIG250 | 61.75 | 8,028 ₽ |

**Аномалии (проверить отдельно):**
- Товары дороже $10,000 - возможно ошибка или цена в юанях
- Товары дешевле $0.10 - слишком дёшево даже для опта

---

## TODO список

### Этап 1: Выгрузка и анализ
- [ ] Выгрузить все 2432 товара (id, name, description, price, category_id)
- [ ] Выгрузить все 40 категорий с иерархией
- [ ] Создать отчёт по текущему распределению

### Этап 2: Нормализация названий
- [ ] Определить товары с мусорными названиями (обрезанные, бессмысленные)
- [ ] Для товаров с описанием - сгенерировать нормальное название из описания
- [ ] Убрать обрезанные "..." в конце названий
- [ ] Исправить кривой перевод где возможно

### Этап 3: Пересортировка по категориям
- [ ] Создать умный классификатор по ключевым словам
- [ ] Для каждого товара определить правильную подкатегорию
- [ ] Учесть контекст (описание, не только название)
- [ ] Выполнить миграцию

### Этап 4: Проверка цен
- [ ] Проанализировать диапазон цен
- [ ] Выявить аномалии (слишком дешёвые/дорогие)
- [ ] Конвертировать если нужно (курс юань → рубль)

### Этап 5: Финальная проверка
- [ ] Проверить что все ROOT категории пустые
- [ ] Проверить релевантность в каждой подкатегории (выборочно)
- [ ] Обновить счётчики product_count
- [ ] Удалить временные файлы

---

## Структура категорий (для справки)

### ROOT → Подкатегории:

**Автотовары**
- Автозапчасти (фильтры, двигатели, тормоза, запчасти)
- Автохимия (мойка, полировка, воск, очистители)
- Шины и диски (шины, диски, колёса, TPMS)

**Здоровье и красота**
- Уход за кожей (кремы, сыворотки, маски, лосьоны)
- Косметика (помада, тени, тушь, макияж)
- Средства гигиены (мыло, шампунь, зубные щётки)
- Витамины и БАД (только витамины, омега, протеин)

**Дом и быт**
- Мебель (столы, стулья, шкафы, кровати)
- Кухонная техника (мясорубки, блендеры, чайники)
- Освещение (лампы, светильники, люстры)
- Текстиль (полотенца, шторы, скатерти)
- Спальня (постельное бельё, подушки, одеяла, матрасы)
- Посуда (тарелки, кружки, кастрюли)
- Декор (зеркала, часы, вазы)
- Сантехника (смесители, унитазы, раковины)
- Системы хранения (полки, органайзеры, ящики)
- Хозяйственные товары (щётки, вёдра, швабры)
- Умный дом (камеры, датчики, умные розетки)
- Аксессуары и фурнитура (крючки, ручки, петли)
- Профессиональная литература (книги)
- Ткани (рулоны ткани, материалы для шитья)
- Одежда оптом (одежда)

**Строительство**
- Инструменты (дрели, пилы, молотки, отвёртки)
- Строительные материалы (цемент, кирпич, плитка)
- Электрика (провода, выключатели, розетки, автоматы)
- Краски и лаки (краски, грунтовки, лаки)
- Крепеж и метизы (болты, гайки, саморезы)
- Двери и окна (двери, окна, фурнитура дверная)
- Отделочные материалы (обои, панели, плинтуса)

**Электроника**
- Смартфоны и планшеты (телефоны, планшеты, чехлы)
- Электроника общего назначения (ноутбуки, USB, кабели, наушники)

**Промышленность**
- Станки и оборудование (станки, прессы, компрессоры)

**Здоровье и медицина**
- Медицинские приборы (тонометры, термометры, массажёры)

---

## Правила классификации

### Приоритет ключевых слов (от высокого к низкому):
1. Точное совпадение категории в названии
2. Специфические термины (TPMS → шины, SPF → уход за кожей)
3. Общие термины (крем, мотор, кабель)
4. Контекст из описания

### Специальные правила:
- "Сыворотка для лица" → Уход за кожей (НЕ витамины)
- "Витамин С крем" → Уход за кожей (НЕ витамины)
- "Подушка/одеяло/матрас" → Спальня
- "Автомобильный пылесос" → Автохимия
- "Электрический инструмент" → Инструменты
- "USB/кабель/зарядка" → Электроника общего назначения
- "Выключатель/розетка" → Электрика
- "Камера наблюдения" → Умный дом
