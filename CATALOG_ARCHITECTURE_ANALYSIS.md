# СРОЧНЫЙ АНАЛИЗ: Почему изображения в каталоге не обновляются?

## ПРОБЛЕМА

Товар "Офисное кресло Gaming Массаж" (ID: `000004a5-0000-0000-0000-000004a50000`) в категории "Мебель"
показывает КЛАВИАТУРУ вместо кресла, несмотря на МНОЖЕСТВЕННЫЕ обновления в базе данных Supabase.

## ЧТО УЖЕ СДЕЛАНО (НЕ ПОМОГЛО)

1. ✅ Заменили изображение в БД - 4 раза разными изображениями
2. ✅ Полностью очистили массив images и установили новое изображение
3. ✅ Добавили cache-busting параметры к URL
4. ✅ Проверили - в БД изображение КОРРЕКТНОЕ
5. ✅ Время последнего обновления: `2025-11-15T15:58:49`
6. ❌ На фронтенде ВСЕ ЕЩЕ показывается клавиатура!

## ТЕКУЩЕЕ СОСТОЯНИЕ В БД

```json
{
  "id": "000004a5-0000-0000-0000-000004a50000",
  "name": "Офисное кресло Gaming Массаж",
  "images": [
    "https://images.unsplash.com/photo-ZOWxCWfltzU?w=800&h=800&fit=crop&q=80"
  ],
  "updated_at": "2025-11-15T15:58:49.971088+00:00"
}
```

## ТВОЯ ЗАДАЧА

Проанализируй архитектуру каталога и ответь на вопросы:

### 1. КАК ОРГАНИЗОВАН КАТАЛОГ?

- Найди ВСЕ файлы связанные с отображением каталога товаров
- Как фронтенд получает данные о товарах?
- Используется ли Server-Side Rendering (SSR)?
- Есть ли статическая генерация страниц (SSG)?
- Какие компоненты отвечают за отображение товаров?

### 2. ГДЕ ПРОИСХОДИТ КЕШИРОВАНИЕ?

Найди ВСЕ места где могут кешироваться данные:
- [ ] Next.js кеширование (fetch, API routes, getStaticProps, getServerSideProps)
- [ ] React Query / SWR кеширование
- [ ] Service Worker кеш
- [ ] CDN кеширование (Vercel, Cloudflare)
- [ ] Браузерный кеш
- [ ] Supabase клиент кеширование

### 3. КАК ДАННЫЕ ЗАГРУЖАЮТСЯ?

- Найди код который делает запросы к Supabase
- Есть ли revalidation настройки?
- Используется ли ISR (Incremental Static Regeneration)?
- Какие заголовки кеширования установлены?

### 4. ПОЧЕМУ ИЗОБРАЖЕНИЕ НЕ ОБНОВЛЯЕТСЯ?

Проанализируй и объясни:
- Почему обновление БД не отражается на фронтенде?
- Где "застряло" старое изображение клавиатуры?
- Какой кеш блокирует обновление?

### 5. КАК ИСПРАВИТЬ?

Предложи КОНКРЕТНЫЕ шаги:
1. Какие файлы нужно изменить?
2. Какие команды выполнить?
3. Как сбросить кеш правильно?
4. Как предотвратить это в будущем?

## СТРУКТУРА ПРОЕКТА

Это Next.js приложение с:
- База данных: Supabase PostgreSQL
- Таблица: `products` с полем `images` (массив URL)
- Хостинг: вероятно Vercel
- Фронтенд: Next.js + React

## ВАЖНЫЕ ФАЙЛЫ ДЛЯ АНАЛИЗА

Найди и проанализируй:
- `app/` или `pages/` структура
- Компоненты каталога
- API routes для товаров
- Supabase клиент конфигурация
- next.config.js
- Middleware (если есть)

## ОЖИДАЕМЫЙ РЕЗУЛЬТАТ

1. Полное объяснение проблемы
2. Точное место где застрял кеш
3. Пошаговый план исправления
4. Код изменений (если нужно)
5. Команды для очистки кеша

## КОНТЕКСТ

Мы уже НЕСКОЛЬКО РАЗ обновляли изображение в БД, но на фронтенде НИЧЕГО НЕ МЕНЯЕТСЯ!
Это означает что проблема НЕ в базе данных, а в архитектуре фронтенда.

НАЙДИ ГДЕ БЛЯТЬ ЗАСТРЯЛ ЭТОТ КЕШ!
